<h3>Sourcefire</h3>
<div class="sectionContainer" *ngIf="tabType === 1">
  <div class="listContainer eventsList">
    <div class="spinner-padding" *ngIf="sourceIPsLoading">
      <mat-spinner diameter="50"></mat-spinner>
    </div>
    <div class="header-container">
      <div class="header-button cursor-pointer" pTooltip="Copy Kusto Query"
        *ngIf="userSearchTerm && userSearchTerm !== '' && startDate && endDate && !sourceIPsLoading">
        <app-copy-button [query]="sourceIPQuery"></app-copy-button>
      </div>
      <table mat-table [dataSource]="topSourceIPs" *ngIf="!sourceIPsLoading" class="mat-elevation-z8">
        <ng-container matColumnDef="IP">
        <th mat-header-cell *matHeaderCellDef> Top {{ntidLimit}} Source IPs</th>
        <td mat-cell *matCellDef="let event" (click)="sourceIPClick(0, event)">
          <span class="p-0p cursor-pointer underline">{{event['Source IP']}}</span>
        </td>
        </ng-container>
        <ng-container matColumnDef="count">
          <th mat-header-cell *matHeaderCellDef>#</th>
          <td mat-cell *matCellDef="let event" (click)="sourceIPClick(1, event)">
          <span class="p-0p cursor-pointer underline">{{event.count_}}</span>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="IPColumns"></tr>
        <tr mat-row class="eventRow" *matRowDef="let myRowData; columns: IPColumns"></tr>
      </table>
    </div>
  </div>
  <div class="listContainer eventsList">
    <div class="spinner-padding" *ngIf="destIPsLoading">
      <mat-spinner diameter="50"></mat-spinner>
    </div>

    <div class="header-container">
      <div class="header-button cursor-pointer" pTooltip="Copy Kusto Query"
        *ngIf="userSearchTerm && userSearchTerm !== '' && startDate && endDate && !destIPsLoading">
        <app-copy-button [query]="destinationIPQuery"></app-copy-button>
      </div>
      <table mat-table [dataSource]="topDestinationIPs" *ngIf="!destIPsLoading" class="mat-elevation-z8">
        <ng-container matColumnDef="IP">
        <th mat-header-cell *matHeaderCellDef>Top {{this.sourceIPLimit}} Destination IPs</th>
        <td mat-cell *matCellDef="let event" (click)="destinationIPClick(0, event)">
          <span class="p-0p cursor-pointer underline">{{event['Destination IP']}}</span>
        </td>
        </ng-container>
        <ng-container matColumnDef="count">
          <th mat-header-cell *matHeaderCellDef>#</th>
          <td mat-cell *matCellDef="let event" (click)="destinationIPClick(1, event)">
          <span class="p-0p cursor-pointer underline">{{event.count_}}</span>
          </td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="IPColumns"></tr>
        <tr mat-row class="eventRow" *matRowDef="let myRowData; columns: IPColumns"></tr>
      </table>
    </div>
  </div>
</div>
<div class="sectionContainer" *ngIf="tabType === 3">
<div class="listContainer eventsList">
  <div class="spinner-padding" *ngIf="sourceIPsLoading">
    <mat-spinner diameter="50"></mat-spinner>
  </div>
  <div class="header-container">
    <div class="header-button cursor-pointer" pTooltip="Copy Kusto Query"
      *ngIf="userSearchTerm && userSearchTerm !== '' && startDate && endDate && !sourceIPsLoading">
      <app-copy-button [query]="domainQuery"></app-copy-button>
    </div>
    <table mat-table [dataSource]="topSourceIPs" *ngIf="!sourceIPsLoading" class="mat-elevation-z8">
      <!-- Top {{ntidLimit}} IDS Alerts -->
      <ng-container matColumnDef="direction">
        <th mat-header-cell *matHeaderCellDef>Direction</th>
        <td mat-cell *matCellDef="let event">
          <span class="p-0p">{{event.direction}}</span>
        </td>
      </ng-container>
      <!-- <ng-container matColumnDef="Alert Category">
        <th mat-header-cell *matHeaderCellDef>Alert Category</th>
        <td mat-cell *matCellDef="let event">
          <span class="p-0p" *ngIf="event['Alert Category'].length <= 10">{{event['Alert Category']}}</span>
          <span class="p-0p" *ngIf="event['Alert Category'].length > 10" [pTooltip]="event['Alert Category']" >{{event['Alert Category'].substring(0, 10) + '...'}}</span>
        </td>
      </ng-container> -->
      <ng-container matColumnDef="Rule Name">
        <th mat-header-cell *matHeaderCellDef>Rule Name</th>
        <td mat-cell *matCellDef="let event">
          <span class="p-0p">{{event['Rule Name']}}</span>
        </td>
      </ng-container>
      <ng-container matColumnDef="Total">
        <th mat-header-cell *matHeaderCellDef>Total</th>
        <td mat-cell *matCellDef="let event" (click)="totalClick(3, event)">
          <span class="p-0p cursor-pointer underline">{{event.Total}}</span>
        </td>
      </ng-container>
      <tr mat-header-row *matHeaderRowDef="IPColumns"></tr>
      <tr mat-row class="eventRow" *matRowDef="let myRowData; columns: IPColumns"></tr>
    </table>
  </div>
</div>
</div>